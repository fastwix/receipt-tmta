<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>ใบเสร็จรับเงิน - TMTA</title>
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      width: 210mm;
      height: 297mm;
      margin: 0;
      padding: 20mm;
      box-sizing: border-box;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .logo {
      width: 100px;
      height: auto;
      margin-bottom: 10px;
    }
    .footer {
      margin-top: 60px;
      font-size: 0.9em;
      text-align: right;
    }
    @media print {
      #printButton { display: none; }
    }
  </style>
</head>
<body>
  <div class="header">
    <img src="https://static.wixstatic.com/media/Logo%20TMTA.png" alt="TMTA Logo" class="logo">
    <h2>ใบเสร็จรับเงิน / Receipt</h2>
  </div>

  <table>
    <tr><td>เลขที่ใบเสร็จ / Receipt No:</td><td id="receiptNo"></td><td>วันที่ / Date:</td><td id="date"></td></tr>
    <tr><td colspan="4">ชื่อสมาชิก / Member Name: <span id="memberName"></span></td></tr>
  </table>

  <table>
    <thead>
      <tr><th>ลำดับ</th><th>รายการ</th><th>จำนวน</th><th>ราคาต่อหน่วย</th><th>ส่วนลด</th><th>จำนวนเงิน</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td id="itemName"></td>
        <td id="itemQty"></td>
        <td id="itemPrice"></td>
        <td id="itemDiscount"></td>
        <td id="itemTotal"></td>
      </tr>
      <tr><td colspan="5" style="text-align:right">รวมเงินทั้งสิ้น / Total:</td><td id="totalText"></td></tr>
      <tr><td colspan="6" style="text-align:left">( <span id="totalInWords"></span> )</td></tr>
    </tbody>
  </table>

  <div class="footer">
    TMTA - Thai Muslim Trade Association<br>
    ขอบคุณที่ใช้บริการ / Thank you
  </div>

  <button id="printButton" onclick="window.print()">พิมพ์ใบเสร็จ</button>

  <script>
    window.addEventListener("message", function(event) {
      const data = event.data;
      if (!data || !data.receiptNo) return;

      document.querySelector("#receiptNo").innerText = data.receiptNo;
      document.querySelector("#date").innerText = data.date;
      document.querySelector("#memberName").innerText = data.memberName;
      document.querySelector("#itemName").innerText = data.item.name;
      document.querySelector("#itemQty").innerText = data.item.quantity;
      document.querySelector("#itemPrice").innerText = data.item.price;
      document.querySelector("#itemDiscount").innerText = data.item.discount;
      document.querySelector("#itemTotal").innerText = data.item.total;
      document.querySelector("#totalText").innerText = data.totalText;
      document.querySelector("#totalInWords").innerText = data.totalInWords;

      setTimeout(() => window.print(), 500);
    });
  </script>
</body>
</html>
